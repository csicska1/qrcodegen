<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <title>Hotspot QR</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial;display:flex;flex-direction:column;gap:12px;align-items:center;padding:40px;background:#fafafa}
    label{font-size:14px}
    input{padding:8px;border:1px solid #ddd;border-radius:6px;width:260px}
    button{padding:8px 12px;border-radius:6px;border:none;background:#111;color:#fff;cursor:pointer}
    canvas{border:1px solid #eee;margin-top:8px}
    .hint{font-size:12px;color:#666}
  </style>
</head>
<body>
  <h2>Hotspot QR — jelszó belepakolva</h2>

  <!-- Fix SSID itt: változtasd meg ha más a hotspot neve -->
  <div>
    <label>SSID (Tóth-pál IPhone):</label>
    <div style="font-weight:600;margin:6px 0">Tóth-pál IPhone</div>
  </div>

  <div>
    <label>Jelszó:</label>
    <input id="pwd" type="text" placeholder="Írd be a hotspot jelszavát" value="" />
  </div>

  <div>
    <label>Titkosítás:</label>
    <select id="enc">
      <option value="WPA" selected>WPA/WPA2</option>
      <option value="WEP">WEP</option>
      <option value="nopass">Nincs jelszó</option>
    </select>
  </div>

  <button id="gen">QR generálása</button>
  <div class="hint">A QR beolvasása után a telefon felajánlja a csatlakozást. Nem kényszerít semmit — csak megkönnyíti a beírást.</div>

  <canvas id="qr"></canvas>

  <script src="qrcodegen.js"></script>
  <script>
    // fix SSID (ha akarod, csinálhatsz inputot is hozzá)
    const SSID = "MyHotspot";

    // escapespecial char per QR Wi-Fi spec (nagyjából)
    function escapeWiFi(s){
      return String(s)
        .replace(/\\/g, "\\\\")
        .replace(/;/g, "\\;")
        .replace(/,/g, "\\,")
        .replace(/:/g, "\\:");
    }

    function makeWifiString(ssid, pwd, enc){
      // if nopass, leave P: empty and T:nopass
      if(enc === "nopass") return `WIFI:T:nopass;S:${escapeWiFi(ssid)};;`;
      return `WIFI:T:${enc};S:${escapeWiFi(ssid)};P:${escapeWiFi(pwd)};;`;
    }

    function generate() {
      const pwd = document.getElementById("pwd").value || "";
      const enc = document.getElementById("enc").value || "WPA";
      const wifiPayload = makeWifiString(SSID, pwd, enc);

      if(!window.QRCode || typeof QRCode.generate !== "function"){
        console.error("QRCode.generate() nem található. Ellenőrizd a qrcodegen.js-t.");
        return;
      }

      const qr = QRCode.generate(wifiPayload, { ecLevel: "M", version: "auto" });
      const canvas = document.getElementById("qr");

      // tisztítás — biztos, ami biztos
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0,0,canvas.width,canvas.height);

      qr.toCanvas(canvas, { scale: 6, margin: 4, dark: "#000", light: "#fff" });
    }

    document.getElementById("gen").addEventListener("click", generate);

    // auto-generate on load with empty (so user can just paste pwd and press button)
    window.addEventListener("DOMContentLoaded", () => {
      // ha szeretnéd, ide állíthatsz alapértéket a jelszónak:
      // document.getElementById('pwd').value = 'supersecret';
      generate();
    });
  </script>
</body>
</html>